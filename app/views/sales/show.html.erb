<script
src="http://code.jquery.com/jquery-3.2.1.min.js"
integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
crossorigin="anonymous"></script>

  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<p id="notice"><%= notice %></p>



<!-- Sales show map starts here -->

<style>
  /* Always set the map height explicitly to define the size of the div
   * element that contains the map. */
  #showmap {
    margin-left: 12%;
    height: 75vh;
    width: 75vw;
  }
</style>

<!-- We pull address from this input -->
<input id="address" type="hidden" value="<%= @sale.street %>,<%= @sale.city %>,<%= @sale.state %>,<%= @sale.zip %>">

<div id="showmap"></div>

<script>
function initMap() {
  var map = new google.maps.Map(document.getElementById('showmap'), {
    zoom: 12,
    center: {lat: 32.70961, lng: -117.1579991}
  });

  var geocoder = new google.maps.Geocoder();
  // document.getElementById('submit').addEventListener('click',
  function geocodeme() {
    geocodeAddress(geocoder, map);
  };
  geocodeme()
}

function geocodeAddress(geocoder, resultsMap) {
  var address = document.getElementById('address').value;
  geocoder.geocode({'address': address}, function(results, status) {
    if (status === 'OK') {
      resultsMap.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({
        map: resultsMap,
        position: results[0].geometry.location
      });
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
}

</script>
  <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC9nhXMWs8RXF_OXTGrVAB7x-msZVhahGw&callback=initMap">
</script>


<!-- Displays sale info: -->

<p>
  <strong>Address: </strong>
  <%= @sale.street %>, <%= @sale.city %>, <%= @sale.state %>, <%= @sale.zip %>
</p>

<p>
  <strong>Date:</strong>
  <%= @sale.date %>
</p>

<p>
  <strong>Time:</strong>
  <%= @sale.time %>
</p>

<p>
  <strong>Description:</strong>
  <%= @sale.description %>
</p>


<!-- Item view and form is below -->

<%= render 'sales/modal' %>
<%#= render 'items/showitems' %>

<div class="col-sm-12">
  <% if @user.nil? %>
  <% else %>
  <% if @sale.user_id == @user.id %>
  <%= render 'items/form' %>
  <%= link_to 'Edit Items', sale_items_path(@sale) %>
  <%= link_to 'Edit Sale', edit_sale_path(@sale) %>
  <% end %>
  <% end %>

  <%= link_to 'Back', sales_path %>
</div>
